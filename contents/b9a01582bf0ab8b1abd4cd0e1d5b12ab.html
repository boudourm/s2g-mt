<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>getOccupantSolarMeters</title>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic|Source+Code+Pro:300,400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../assets/css/bootstrap.css">
<link rel="stylesheet" href="../assets/css/jquery.bonsai.css">
<link rel="stylesheet" href="../assets/css/main.css">
<link rel="stylesheet" href="../assets/icon-font/icons.css">
<script type="text/javascript" src="../assets/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="../assets/js/bootstrap.js"></script>
<script type="text/javascript" src="../assets/js/jquery.bonsai.js"></script>

  </head>
  <body>
    <div>

      <!-- Name Title -->

      <h1>getOccupantSolarMeters</h1>

      <!-- Type and Stereotype -->

      <section style="margin-top: .5em;">
        <span class="alert alert-info">
          <span class="node-icon staruml-icon icon-UMLOperation"></span>
          UMLOperation
        </span>
        
      </section>

      <!-- Path -->

      <section style="margin-top: 10px">
        
        
        
          
          <span class="label label-info"><a href='cf9c8b720f3815adeccaf3ef6e48c6c4.html'><span class='node-icon staruml-icon icon-Project'></span>S2G-MT</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='fce469f062f90d11f64d670985ff5dd6.html'><span class='node-icon staruml-icon icon-UMLSubsystem'></span>S2G-MT-Services</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='b94f39fbec2b2fc58ff3985d3ab16e54.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>net</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='3a16b09d216457df8b2dfdc270112f06.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>atos</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='972cb86a08cbe45b26c8109675e14058.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>s2g</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='817926576256700ebc92d8ba715ea2b5.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>mt</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='cbe24923edd1a0fabf1f08f05ee90bf7.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>services</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='64d368cc06913bbb4f5b1cbbad4d0d43.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>producer</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='d2dca84549a549e265a3bc55280002f3.html'><span class='node-icon staruml-icon icon-UMLClass'></span>ConsoService</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='b9a01582bf0ab8b1abd4cd0e1d5b12ab.html'><span class='node-icon staruml-icon icon-UMLOperation'></span>getOccupantSolarMeters</a></span>
        
      </section>

      <!-- Diagram -->

      

      <!-- Description -->

      
      <section>
        <h3>Description</h3>
        <div>
          
            <p>Récupération de parametre en base
Ce parametre permet de borner la date fin des données (il faut que les donnees soient validées par le systeme)
L&#39;occupant est bien présent dans son appartement pour le mois et l&#39;année demandée
L&#39;occupant doit occuper un logement de type private
Récupération des données de configuration en base pour définir le % d&#39;une conso normale: + ou - 5% par defaut
Calcul des bornes pour le mois précedant, attention si l&#39;occupant n&#39;occupe pas son logement durant ce mois, alors on ne pourra pas faire de comparaison avec ce mois!
Récupération des consommations.
Recupération des données PRIVEES du mois précedant
Recupération des données COLLECTIVES du mois précedant
Récupération des données PRIVEE du mois courant
Récupération des données COLLECTIVES du mois courant
calculé en front-end ?...
Integer currentMonthNbDays = consoJSON.getElec().getIndividuel().getConsumptions().size();
				Integer previousMonthNbDays = consoJSON.getElec().getIndividuel().getPreviousPeriodNbDays();
				Double consoMoyenneMoisCourant = consoJSON.getElec().getIndividuel().getTotalEnergyConsumption() / Math.max(currentMonthNbDays, 1);
				Double consoMoyenneMoisPrecedant=null;
				Double energyGapPourcentage=null;
				if(previousMonthNbDays!=null &amp;&amp; consoJSON.getElec().getIndividuel().getPreviousPeriodEnergyConsumption()!=null){
					consoMoyenneMoisPrecedant = previousMonthNbDays != 0 ? consoJSON.getElec().getIndividuel().getPreviousPeriodEnergyConsumption() / previousMonthNbDays : 0.d;</p>

<pre><code>			}
			Double percentage = consoJSON.getConsumptionPercentage()</code></pre>

<p>100;</p>

<pre><code>			if(consoMoyenneMoisPrecedant!=null &amp;&amp; consoMoyenneMoisCourant!=null &amp;&amp;consoMoyenneMoisPrecedant!=null){
				energyGapPourcentage = consoMoyenneMoisPrecedant == 0.d ? 0 : (consoMoyenneMoisCourant</code></pre>

<p>100 / consoMoyenneMoisPrecedant) - 100;</p>

<pre><code>				if(energyGapPourcentage &gt; percentage) consoJSON.getElec().setDiffclass(&quot;up&quot;);
				else if(energyGapPourcentage &lt; -percentage) consoJSON.getElec().setDiffclass(&quot;down&quot;);
				else consoJSON.getElec().setDiffclass(&quot;zero&quot;);



			}
			else{
				energyGapPourcentage=new Double(0);
			}


			// Calculer la tendance pour le water
			currentMonthNbDays = consoJSON.getWater().getIndividuel().getConsumptions().size();
			previousMonthNbDays = consoJSON.getWater().getIndividuel().getPreviousPeriodNbDays();
			consoMoyenneMoisCourant = consoJSON.getWater().getIndividuel().getTotalEnergyConsumption() / Math.max(currentMonthNbDays, 1);
			if(previousMonthNbDays!=null &amp;&amp; consoJSON.getWater().getIndividuel().getPreviousPeriodEnergyConsumption()!=null){
				consoMoyenneMoisPrecedant = previousMonthNbDays != 0 ? consoJSON.getWater().getIndividuel().getPreviousPeriodEnergyConsumption() / previousMonthNbDays : 0.d;


			}
			if(consoMoyenneMoisPrecedant!=null &amp;&amp; consoMoyenneMoisCourant!=null &amp;&amp;consoMoyenneMoisPrecedant!=null){
				energyGapPourcentage = consoMoyenneMoisPrecedant == 0.d ? 0 : (consoMoyenneMoisCourant</code></pre>

<p>100 / consoMoyenneMoisPrecedant) - 100;
					if(energyGapPourcentage &gt; percentage) consoJSON.getWater().setDiffclass(&quot;up&quot;);
					else if(energyGapPourcentage &lt; -percentage) consoJSON.getWater().setDiffclass(&quot;down&quot;);
					else consoJSON.getWater().setDiffclass(&quot;zero&quot;);
				}
				else{
					energyGapPourcentage=new Double(0);
				}
Récupération des compteurs solaires associés au logement
@param idOcpt
@param idPremise
@param ocpyStart
@return la liste des compteurs (automatiques et manuels) de l&#39;occupant associé au logement ainsi que le fluid</p>
          
        </div>
      </section>
      

      <!-- Specification -->

      

      <!-- Directed Relationship -->

      

      <!-- Undirected Relationship -->

      

      <!-- Classifier -->

      

      <!-- Interface -->

      

      <!-- Component -->

      

      <!-- Node -->

      

      <!-- Actor -->

      

      <!-- Use Case -->

      

      <!-- Template Parameters -->

      

      <!-- Literals -->

      

      <!-- Attributes -->

      

      <!-- Operations -->

      

      <!-- Receptions -->

      

      <!-- Extension Points -->

      

      <!-- Parameters -->

      
      <section>
        <h3>Parameters</h3>
        <table class="table table-striped table-bordered">
          <tr>
            <th>Direction</th>
            <th>Name</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
          
          <tr>
            <td>in</td>
            <td><a href="54e0877781be5351d581c215e7815a0b.html">idOcpy</a></td>
            <td>Long</td>
            <td></td>
          </tr>
          
          <tr>
            <td>in</td>
            <td><a href="464438785ace6084e8a4298b41bf8c1c.html">idOcpt</a></td>
            <td>Long</td>
            <td></td>
          </tr>
          
          <tr>
            <td>in</td>
            <td><a href="24264c6d212d742597b64e4b87b82a00.html">idPremise</a></td>
            <td>Long</td>
            <td></td>
          </tr>
          
          <tr>
            <td>in</td>
            <td><a href="a7b972e61a0401c6c8bec8e2e59ce37d.html">ocpyStart</a></td>
            <td><span class='label label-info'>void</span></td>
            <td></td>
          </tr>
          
          <tr>
            <td>return</td>
            <td><a href="1e1840f47db94375bdfc55d79ba7aa63.html">(unnamed)</a></td>
            <td><span class='label label-info'>void</span></td>
            <td></td>
          </tr>
          
        </table>
      </section>
      

      <!-- Diagrams -->

      
      

      <!-- Behavior -->

      

      <!-- Action -->

      

      <!-- Interaction -->

      

      <!-- CombinedFragment -->

      

      <!-- Activity -->

      

      <!-- State Machine -->

      

      <!-- State Machine -->

      

      <!-- State -->

      

      <!-- Vertex -->

      

      <!-- Transition -->

      

      <!-- Data Model (ERD) -->

      

      <!-- Columns (ERD) -->

      

      <!-- Related Entities (ERD) -->

      

      <!-- Data Flows (DFD) -->

      

      <!-- Flows (Flowchart) -->

      

      <!-- Properties -->

      <section>
        <h3>Properties</h3>
        
        <table class="table table-striped table-bordered">
    <tr>
        <th width="50%">Name</th>
        <th width="50%">Value</th>
    </tr>
    
    
    
    
    
    
    
    <tr>
        <td>name</td>
        <td>getOccupantSolarMeters</td>
    </tr>
    
    
    
    
    
    
    
    
    
    
    
    <tr>
        <td>stereotype</td>
        <td><span class='label label-info'>null</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>visibility</td>
        <td>public</td>
    </tr>
    
    
    
    
    
    
    
    <tr>
        <td>isStatic</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isLeaf</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>parameters</td>
        <td>
            
            
            <a href='54e0877781be5351d581c215e7815a0b.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>idOcpy</a>
            
            <span>, </span>
            <a href='464438785ace6084e8a4298b41bf8c1c.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>idOcpt</a>
            
            <span>, </span>
            <a href='24264c6d212d742597b64e4b87b82a00.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>idPremise</a>
            
            <span>, </span>
            <a href='a7b972e61a0401c6c8bec8e2e59ce37d.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>ocpyStart</a>
            
            <span>, </span>
            <a href='1e1840f47db94375bdfc55d79ba7aa63.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>(Parameter)</a>
            
        </td>
    </tr>
    
    
    
    
    
    <tr>
        <td>raisedExceptions</td>
        <td>
            
        </td>
    </tr>
    
    
    
    
    
    <tr>
        <td>concurrency</td>
        <td>sequential</td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isQuery</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isAbstract</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>specification</td>
        <td></td>
    </tr>
    
    
    
    
    
    
    
    
    
</table>                

      </section>

      <!-- Tags -->

      

      <!-- Constraints, Dependencies, Dependants -->

      
        
        


        
        


        
        

      

      <!-- Relationships -->

      
      


      <!-- Owned Elements -->

      
      


    </div>
  </body>
</html>
